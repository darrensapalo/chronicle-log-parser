import Head from 'next/head'
import LogParser from './log_parser'
import Markdown from './markdown'
import { useState } from 'react'
import Script from 'next/script';

export default function Home() {
  const [isLoading, setLoading] = useState<boolean>(false);
  const [markdownContent, setMarkdownContent] = useState<string>(`
  Hi! Once you've input your raw log event and Logstash parser code, click "Simulate Parsing"!
  
  The tool will:
  1. Parse your log using the Logstash grok patterns
  2. Map the parsed fields to Google Chronicle UDM model
  3. Provide detailed explanation of the mapping
  4. Offer suggestions for improvement
  `);

  const handleRequest = () => {
    setLoading(true);
  }

  const handleContentChange = (response: string) => {
    setLoading(false);
    setMarkdownContent(response);
  };

  return (
    <>
      <Head>
        <title>Google Chronicle Log Parser</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossOrigin="anonymous" />
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
      </Head>
      <Script id="google-analytics">
        {`
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-5QJBTE12CN');
        `}
      </Script>
      <Script src="https://www.googletagmanager.com/gtag/js?id=G-5QJBTE12CN"></Script>
      <main className="h-full bg-white p-8 overflow-y-auto flex flex-col">
        <div className="flex flex-col w-full">
          <LogParser onRequest={handleRequest} onParse={handleContentChange}></LogParser><br />
        </div>
        <div className='flex flex-col'>
        <div className="flex flex-row">
            <span className='text-xs italic mt-4 text-slate-400'>
              Made for <a className="link underline underline-offset-4" href="https://www.linkedin.com/in/carmela-sevilla/">Carmela Sevilla</a>. 
              See <a className="link underline underline-offset-4" href="https://github.com/darrensapalo/chronicle-log-parser">GitHub source code</a>. 
              See <a className="link underline underline-offset-4" href="https://github.com/darrensapalo/chronicle-log-parser/tree/main/lib">parser implementation</a>. 
            </span>
          </div>
          <div className="flex flex-row">
            <span className='text-xs italic my-4 text-slate-400'>
              Resources: 
              <a className="link underline underline-offset-4 mx-2" href="https://cloud.google.com/chronicle/docs/preview/parser-extensions/parsing-overview">Chronicle Log Parsing</a>
              <a className="link underline underline-offset-4 mx-2" href="https://www.elastic.co/guide/en/logstash/current/advanced-pipeline.html">Parsing with Logstash</a>
              <a className="link underline underline-offset-4 mx-2" href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html">Grok filter plugin</a>
              <a className="link underline underline-offset-4 mx-2" href="https://cloud.google.com/chronicle/docs/reference/udm-field-list">UDM field list</a>
              
              
            </span>
          </div>
        </div>
        
      </main>
    </>
  )
}
