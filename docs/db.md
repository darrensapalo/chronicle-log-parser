# Database Design

## Overview
This project uses Neon Postgres to store log transformations and user feedback.

## Tables

### `log_transformations`
Stores each log transformation generated by the API.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| id | SERIAL | NO | Primary key |
| api_version | INTEGER | NO | Version of the API that generated this transformation |
| author | TEXT | YES | External ID from auth service (nullable for now) |
| raw_log | TEXT | NO | Original input log data |
| filter_code | TEXT | NO | Logstash/filter code used for transformation |
| generated_output | TEXT | NO | Result of the transformation |
| created_at | TIMESTAMP | NO | When the transformation was created (default: NOW()) |

### `transformation_reports`
Stores user reports about incorrect transformations.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| id | SERIAL | PRIMARY KEY | NO | Primary key |
| transformation_id | INTEGER | NO | Foreign key to log_transformations(id) |
| remarks | TEXT | NO | User's feedback about the incorrect transformation |
| created_at | TIMESTAMP | NO | When the report was submitted (default: NOW()) |

**Index:** `idx_transformation_reports_transformation_id` on `transformation_id` for faster lookups.

## Migration Strategy
Using Prisma for:
- Type-safe database access
- Auto-generated TypeScript types
- Migration management

## Future Enhancements
- Add authentication and populate `author` field
- Allow users to view historical transformations
- Track and analyze common transformation errors
